<main class="fit-to-page app-targets">
  <h1 class="page-title">Europeana member state targets</h1>

  <span class="page-subtitle">
    <span *ngFor="let c of pinnedCountries | keyvalue">
      {{ c.key | renameCountry }}
    </span>
  </span>

  <div class="chart-and-legend-wrapper">
    <div class="headed-item">
      <span class="item-header">Data Over Time </span>

      <div class="line-chart-wrapper">
        <app-line-chart #lineChart [targetData]="targetData"> </app-line-chart>
        <a class="data-link hover-show"
          >Chart options
          <div class="hover-show-content">
            <span class="hover-show-content-inner">
              <a style="data-link" (click)="toggleScrollbar()"
                >&lt; toggle scrollbar</a
              >
              <br />
              <a style="white-space: nowrap" (click)="toggleCursor()"
                >&lt; toggle cursor</a
              >
              <br />
              <a style="white-space: nowrap" (click)="toggleGridlines()"
                >&lt; toggle gridlines</a
              >
            </span>
          </div>
        </a>
      </div>
    </div>

    <div class="headed-item">
      <span class="item-header">Data Selection</span>

      <ng-container *ngIf="lineChart">
        <app-legend-grid
          [countryData]="countryData"
          [targetData]="targetData"
          [lineChart]="lineChart"
        ></app-legend-grid>
      </ng-container>

      <a class="data-link hover-show"
        >View country data
        <div class="hover-show-content">
          <span class="hover-show-content-inner">
            Will open
            <code><pre>/data/country[?newParam]</pre></code> overlaid with the
            (all-records) target data
          </span>
        </div>
      </a>
    </div>
  </div>

  <div class="headed-item appendice-grid-wrapper">
    <span class="item-header">Member State Data</span>

    <div class="appendice-grid">
      <span class="header"> Date </span>
      <span class="header"> Country </span>
      <span class="header"> Total </span>
      <span class="header"> (2025) </span>
      <span class="header"> (2030) </span>
      <span class="header"> 3D </span>
      <span class="header"> (2025) </span>
      <span class="header"> (2030) </span>
      <span class="header"> Meta Tier A </span>
      <span class="header"> (2025) </span>
      <span class="header"> (2030) </span>

      <ng-container *ngFor="let country of pinnedCountries | keyvalue">
        <ng-container *ngFor="let row of countryData[country.key]">
          <ng-container *ngIf="targetData[country.key]">
            <span>
              {{ row["date"] | date: "dd/MM/yyyy" }}
            </span>
            <span>
              {{ country.key | renameCountry }}
            </span>
            <span>
              {{ row["total"] | number }}
            </span>
            <span>
              {{ targetData[country.key]["total"][0].value | json }}
            </span>
            <span>
              {{ targetData[country.key]["total"][1].value | json }}
            </span>
            <span>
              {{ row["three_d"] | number }}
            </span>
            <span>
              {{ targetData[country.key]["three_d"][0].value | json }}
            </span>
            <span>
              {{ targetData[country.key]["three_d"][1].value | json }}
            </span>
            <span>
              {{ row["meta_tier_a"] | number }}
            </span>
            <span>
              {{ targetData[country.key]["meta_tier_a"][0].value | json }}
            </span>
            <span>
              {{ targetData[country.key]["meta_tier_a"][1].value | json }}
            </span>
          </ng-container>
        </ng-container>
      </ng-container>
    </div>
  </div>
</main>
