<ngx-datatable
  *ngIf="tableData"
  #dataTable
  id="dataTable"
  [groupRowsBy]="'name'"
  [rows]="tableData.tableRows"
  class="material expandable datatable fullscreen"
  [columnMode]="ColumnMode.flex"
  [headerHeight]="50"
  [footerHeight]="60"
  [rowHeight]="50"
  [scrollbarV]="false"
  [limit]="5"
>
  <!--   Mobile row detail -->

  <ngx-datatable-row-detail [rowHeight]="50">
    <ng-template
      let-row="row"
      let-expanded="expanded"
      ngx-datatable-row-detail-template
    >
      <div class="mobile-row">
        <span
          *ngFor="let col of tableData.columns | slice: 1"
          class="mobile-row-detail"
        >
          {{ row[col] }}</span
        >
      </div>
    </ng-template>
  </ngx-datatable-row-detail>

  <!-- Mobile controls -->

  <ngx-datatable-column
    [width]="50"
    [resizeable]="false"
    [sortable]="false"
    [draggable]="false"
    [canAutoResize]="false"
  >
    <ng-template
      let-row="row"
      let-expanded="expanded"
      ngx-datatable-cell-template
    >
      <a
        href="#"
        [class.datatable-icon-right]="!expanded"
        [class.datatable-icon-down]="expanded"
        title="Expand / Collapse Row"
        (click)="toggleExpandRow(row)"
        class="desktop-hidden"
      >
      </a>
    </ng-template>
  </ngx-datatable-column>

  <!-- End Mobile controls -->

  <!-- Col 0 (expand column) -->
  <ngx-datatable-column
    name="{{ tableData.columns[2] | titlecase }}"
    [flexGrow]="3"
    [minWidth]="200"
  >
    <ng-template let-value="value" let-row="row" ngx-datatable-cell-template>
      <a target="_blank" [href]="getUrlRow(value)" class="container-h">
        <span class="name-cell">
          {{ value }}
        </span>
        <span *ngIf="showingSeriesInfo" class="container-h">
          <span
            class="series-colour"
            [ngStyle]="{
              backgroundColor: colours[row['colourIndex']]
            }"
          ></span>
          <span>
            {{ row.series }}
          </span>
        </span>
      </a>
    </ng-template>
  </ngx-datatable-column>

  <!-- Col >= 1 -->
  <ngx-datatable-column
    *ngFor="let col of tableData.columns | slice: 3; index as i"
    name="{{ col | titlecase }}"
    [flexGrow]="1"
  >
    <ng-template
      let-column="column"
      let-sort="sortFn"
      ngx-datatable-header-template
    >
      <span class="mobile-hidden">{{ column.name }}</span>
    </ng-template>
    <ng-template let-value="value" ngx-datatable-cell-template>
      <span class="mobile-hidden">{{ value }}</span>
    </ng-template>
  </ngx-datatable-column>

  <!-- Footer -->

  <ngx-datatable-footer>
    <ng-template
      ngx-datatable-footer-template
      let-rowCount="rowCount"
      let-pageSize="pageSize"
      let-selectedCount="selectedCount"
      let-curPage="curPage"
      let-offset="offset"
    >
      <div class="table-footer">
        <div class="table-footer-total">
          <strong>Total</strong>: {{ totalResults }}
        </div>
        <a [href]="getUrl(true)" target="_blank">View in portal</a>
      </div>

      <datatable-pager
        [pagerLeftArrowIcon]="'datatable-icon-left'"
        [pagerRightArrowIcon]="'datatable-icon-right'"
        [pagerPreviousIcon]="'datatable-icon-prev'"
        [pagerNextIcon]="'datatable-icon-skip'"
        [page]="curPage"
        [size]="pageSize"
        [count]="rowCount"
        [hidden]="!(rowCount / pageSize > 1)"
        (change)="dataTable.onFooterPage($event)"
      >
      </datatable-pager>
    </ng-template>
  </ngx-datatable-footer>
</ngx-datatable>
